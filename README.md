# ファイル配置チェックツール（Portfolio）

## 概要

業務で使用される **管理表（Excel）** と **実体フォルダ** の内容を突き合わせ、
「管理表に記載されているファイル名が実態フォルダに正しく配置されているか」を自動で確認するためのGUIツールです。

Python（Tkinter）を用いて、**非エンジニアでも利用できる操作性**と、
**人が作成・更新するExcelを前提とした堅牢なチェック処理**を意識して設計しました。

---

## 開発背景・課題

現場では以下のような課題がありました。

* 管理表と実体フォルダの内容が一致しているかを **目視・手作業** で確認していた
* 管理表には記載されているが、実際にはファイルが存在しないケースが発生していた
* フォルダ構成が複雑で、ファイルの配置場所を把握するのに時間がかかっていた
* ツール利用者は必ずしもエンジニアではなく、**GUI操作が必須**だった

これらを背景に、
「誰でも簡単に配置漏れを検出できる仕組み」を目的として本ツールを作成しました。

---

## 解決アプローチ

* Excelの管理表を正とし、記載された実行ファイル名を基準にチェック
* 指定フォルダ配下を再帰的にスキャンし、実体ファイルを自動収集
* 結果を一覧表示し、未検出ファイルを一目で判別できるUIを提供

**チェック作業を自動化し、人の確認工数と見落としを削減**することを狙いました。

---

## 使用技術

* Python 3
* Tkinter（GUI構築）
* tkinterdnd2（ドラッグ＆ドロップ対応）
* openpyxl（Excel読み込み）
* pathlib（ファイル／ディレクトリ操作）

---

## 工夫した点・設計上のポイント

### 1. 人が作るExcelを前提にした設計

* 実ファイル名は **5行目** を対象行として固定
* ヘッダ行や区切り行（`■`、`―`）は自動的に除外
* 特定のシート名は対象外とすることで誤検出を防止

→ 実運用で「表の揺れ」があっても破綻しにくい構成にしました。

---

### 2. 拡張子に依存しないファイル照合

* フォルダ内ファイルは **拡張子を除いたファイル名（stem）** で管理
* 実行形式が異なっても同一ファイルとして判定可能

---

### 3. 再帰的なフォルダ走査と重複検出

* フォルダ配下を再帰的に検索
* 同名ファイルが複数パスに存在する場合もすべて表示

→ 「どこに置かれているか分からない」問題を可視化

---

### 4. 視認性を重視したUI

* TreeViewで結果を一覧表示
* 未検出ファイルは **赤背景** で強調表示
* 同一の開発名・ファイル名は連続行では省略表示し、可読性を向上

---

### 5. 操作負荷を下げる工夫

* Excelファイル／フォルダの **ドラッグ＆ドロップ対応**
* 入力が揃った時点で自動チェック可能

→ 非エンジニアでも迷わず使える操作感を意識しました。

---

## 成果・効果

* 配置確認作業を手動から自動化
* ファイルの配置漏れ・誤配置を早期に検出可能
* フォルダ構成の把握にかかる時間を削減
* エンジニア以外のメンバーでも自己チェックが可能に

---

## 制約・今後の改善案

* 大規模フォルダではスキャンに時間がかかる可能性がある
* Excelフォーマット（対象行・列）が固定のためEXcelのテンプレートが変更の場合などは修正が必要
* 今後の改善案

  * 結果のCSV／Excel出力
  * 処理進捗のプログレスバー表示
  * 設定ファイルによる柔軟なフォーマット対応

---

## まとめ

実装にあたってはAI支援ツールを活用しつつ、要件整理・設計判断・仕様調整および最終的なコードレビューは自身で行いました。

本ツールは、単なるファイル検索ではなく、
**業務フロー（管理表 × 実体フォルダ）を理解した上で設計したチェックツール**です。

業務課題を整理し、
「誰が・どのように使うか」を意識して設計・実装した点を強みとしています。
